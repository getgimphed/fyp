{% extends 'vbase.html' %}
{% block content %}
        <script type="text/javascript">
        window.addEventListener('keydown',function(e){if(e.keyIdentifier=='U+000A'||e.keyIdentifier=='Enter'||e.keyCode==13){if(e.target.nodeName=='INPUT'&&e.target.type=='text'){e.preventDefault();return false;}}},true);
        </script>
        <!--validation-->
        <script type="text/javascript">
            function validateform(){
              var form = document.forms['serviceform'];
              service_end_date_time =form['service_end_date_time'].value;
              service_start_date_time = form['service_start_date_time'].value;
              reason = form['reason'].value;
              if ( reason == null || reason=="")
              {
                toastr.info('Reason for service not provided');
                return false;
              }
              if( !datetimevalid(service_start_date_time)){
                toastr.warning('Service start date time format not correct. Use YYYY-MM-DD HH:MM:SS format');
                return false;
              }
              if( !datetimevalid(service_end_date_time)){
                toastr.warning('Service end date time format not correct. Use YYYY-MM-DD HH:MM:SS format');
                return false;
              }
              if(service_start_date_time >service_end_date_time){
                toastr.warning('Service end time should be after service start time');
                return false;
              }
              toastr.success('Bike service successfully added.', 'Success', {timeOut: 6000});
              setInterval(function(){return true;},3000);
              };
              function startTimer () {
               timer.start();
                setTimeout(stopTimer,3000);
              };

              function stopTimer () {
               timer.stop();
              };
              function yearvalid(year){
              if(year==""|| year== null);
              if (year.match(/^20[0-9]{2}$/)) {
                return true;
              }
                return false;
              };
              function datetimevalid(date){
              console.log(date)
            if (date.match(/^(19|20)[0-9]{2}[\-.](?:(0[1-9]|1[012])[\-.](0[1-9]|[12][0-9]|3[01]) ([01]?[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]))$/)){
                return true;
              }
              else{
                  return false;
               }
              };
              </script>
          <!--validation-end-->
<div class="container">
{% if edit %}
<div class = "row"><h3>Edit service details</h3></div>
<form class="form-horizontal" name="serviceform" action="{% url 'vendorslocationsbikesservice-list' %}" method ="POST"  role="form" onsubmit="return validateform()"> 
<input type="hidden" value="True" name="edit">
{% else %}
<form class="form-horizontal" name="serviceform" action="{% url 'vendorslocationsbikesservice-list' %}" method ="POST"  role="form" onsubmit="return validateform()">
<div class = "row"><h3>Add service details</h3></div> 
{% endif %} 
        
            {% csrf_token %}
            <input type="hidden" value="{{ ven_loc_bikes }}" name="ven_loc_bikes">

            <div class="form-group">
              <label class="control-label col-sm-2" for="service-reason">{{ form.reason.label_tag }}</label>
             <div class="col-sm-10  "> 
              {{ form.reason }}
             </div>
            </div>
            <div class="form-group"> 
                   <label class="control-label col-sm-2 " for="service-start-date-time">{{ form.service_start_date_time.label_tag }}</label>

                <div class="col-sm-10"> 
                   {{ form.service_start_date_time }}
                  </div>
            </div>
            <div class="form-group">
              <label class="control-label col-sm-2" for="service-end-date-time">{{ form.service_end_date_time.label_tag }}</label>
             <div class="col-sm-10  "> 
              {{ form.service_end_date_time }}
             </div>
            </div>
            <div class="form-group"> 
                  <div class="col-sm-offset-2 col-sm-10">
               <button type="submit" class="btn btn-default">Submit</button>
             </div>
            </div>
            </form>
{% endblock %}
