{% extends 'vbase.html' %}
{% block content %}
        <script type="text/javascript">
        window.addEventListener('keydown',function(e){if(e.keyIdentifier=='U+000A'||e.keyIdentifier=='Enter'||e.keyCode==13){if(e.target.nodeName=='INPUT'&&e.target.type=='text'){e.preventDefault();return false;}}},true);
        </script>
        <!--validation-->
        <script type="text/javascript">
            function validateform(){
              var form = document.forms['bikedetail'];
              reg =form['reg_number'].value;
              color = form['color'].value;
              insurance_last_date_time = form['insurance_last_date_time'].value;
              years_of_manu = form['years_of_manu'].value;
              next_service_date_time = form['next_service_date_time'].value;
              if ( reg == null || reg=="")
              {
                toastr.info('Bike Registration No. not provided');
                return false;
              }
              if( color =="" || color ==null){
                toastr.warning('Bike color not provided');
                return false;
              }
              if( datevalid(insurance_last_date_time) ){
                if (new Date(insurance_last_date_time).getTime < new Date().getTime()){
                toastr.warning('Insurance last date can\'t be less than present date');
                console.log(new Date());
                console.log(insurance_last_date_time);
                return false;
                }
              }
              if( !datevalid(insurance_last_date_time) ){
                  toastr.warning('Insurance  date format not correct. Use YYYY-MM-DD format');
                  return false;
                }
              if (!datevalid(years_of_manu)){
                toastr.warning('Year of manufacture not provided. Use YYYY format');
                return false;
              }
              if(!datevalid(next_service_date_time)){
                toastr.warning('Service date format not correct. Use YYYY-MM-DD format');
                return false;
              }
              toastr.success('Bike details successfully added.', 'Success', {timeOut: 6000});
              setInterval(function(){return true;},6000);
              
              
            };
            function startTimer () {
               timer.start();
                setTimeout(stopTimer,2000);
            };

            function stopTimer () {
               timer.stop();
            };
            function yearvalid(year){
              if(year==""|| year== null);
              if (year.match(/^20[0-9]{2}$/)) {
                return true;
              }
                return false;
            };
            function datevalid(date){
              console.log(date)
            if (date.match(/^(19|20)[0-9]{2}[\-.](?:(0[1-9]|1[012])[\-.](0[1-9]|[12][0-9]|3[01]))$/)){
                return true;
            }
            else{
                  return false;
              }
            };
          </script>
          <!--validation-end-->
<div class="container">
{% if edit %}
<div class = "row"><h3>Edit Bike Details</h3></div> 
    <form class="form-horizontal" name="bikedetail" action="{% url 'vendorslocationsbikesdetails-list' %}" method ="POST"  role="form" onsubmit="return validateform()">
    <input type="hidden" value="True" name="edit">
{% else %}
<div class = "row"><h3>Add Bike Details</h3></div>
    <form class="form-horizontal" name="bikedetail" action="{% url 'vendorslocationsbikesdetails-list' %}" method ="POST"  role="form" onsubmit="return validateform()">
{% endif %}
            {% csrf_token %}
            <!-- <div class="form-group">
                <label class="control-label col-sm-2" for="bike-model">{{ form.ven_loc.label_tag }}</label>
                <div class="col-sm-10">
                {{ form.ven_loc }}
                </div>
            </div> -->
            <input type='hidden' value="{{ edit }}" name="edit">
            <input type="hidden" value="{{ ven_loc_bikes }}" name="ven_loc_bikes">
            <input type="hidden" value="{{ detailid }}" name="detailid">
            <div class="form-group">
                <label class="control-label col-sm-2" for="bike-model">{{ form.reg_number.label_tag }}</label>
                <div class="col-sm-10">
                {{ form.reg_number }}
                </div>
            </div>
            <div class="form-group">
              <label class="control-label col-sm-2" for="bike-deposit">{{ form.color.label_tag }}</label>
             <div class="col-sm-10"> 
              {{ form.color }}
             </div>
            </div>
            <div class="form-group"> 
                   <label class="control-label col-sm-2 " for="bike-rent">{{ form.insurance_last_date_time.label_tag }}</label>

                <div class="col-sm-10"> 
                   {{ form.insurance_last_date_time }}
                  </div>
            </div>

            <div class="form-group"> 
                   <label class="control-label col-sm-2 " for="bike-rent">{{ form.years_of_manu.label_tag }}</label>

                <div class="col-sm-10"> 
                   {{ form.years_of_manu }}
                  </div>
            </div>

            <div class="form-group"> 
                   <label class="control-label col-sm-2 " for="bike-rent">{{ form.next_service_date_time.label_tag }}</label>

                <div class="col-sm-10"> 
                   {{ form.next_service_date_time }}
                  </div>
            </div>
            <div class="form-group"> 
                  <div class="col-sm-offset-2 col-sm-10">
               <button type="submit" class="btn btn-default">Submit</button>
             </div>
            </div>
            </form>
      </div>

{% endblock %}